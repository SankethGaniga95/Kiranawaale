<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KiranaWaale</title>
    <link rel = "icon" href ="./images/KW.png" 
            type = "image/x-icon">

   
    <link rel="stylesheet" type="text/css" href="food.css" />
</head>
<body>
    <div class="nav">
        <div id="left">
        <img src="./images/KW (2) logo.png" alt="">
      

        <a href="">Coupon & Deals</a>
        <a href="">Weekly Ads</a>
        <a href="./Cart.html">My Cart</a>
        </div>

        <div id="right">
        <form>
        <input type="text" placeholder="Search for a product" id="Search">
        <!-- <button>Search</button> -->
        </form>
        </div>
</div> 
        <div id="foodpage">
        <div id="foodsidebar" >
       
            <select id="filter">
                <option value="">Filter By Rating</option>
                <option value="5">5</option>
                <option value="4">4</option>
                <option value="3">3</option>
                <option value="2">2</option>
                <option value="1">1</option>
            </select>
            <hr>
            <div class="dropdown">
                <span>Categories</span>
                <div class="dropdown-content">
                    <p id="Food & Beverage">Food & Beverage</p>
                     <p id="Beaut">Beauty</p>
                    <p id="Cleanin">Cleaning</p>
                    <p id="Personal Car">Personal Care</p>
                    <p id="Toy">Toys</p>
                    <p id="Bab">Baby</p>
                    <p id="Healt">Health</p>
                    <p id="Househol">Household</p>
                    <p id="Party & Occasion">Party & Occasions</p> 
                </div>
            </div>

        </div>
        <div id="foodcontainer">

        </div>
    </div>
</body>
</html>
<script>
    async function FetchData(){
        try{
            let res=await fetch("./data/Food.json")
            res=await res.json()
            console.log(res);
            filterData(res.data)
            //  DisplayFood(res.data)
        }catch(err){
            console.log(err)
        }
       
    }
     FetchData()


     let filterBy=document.getElementById("filter")
     filterBy.addEventListener("change",()=>{
        FetchData()
     })
     function filterData(data){
        let filterValue=filterBy.value
        if(filterValue===""){
            DisplayFood(data)
        }else{
            data=data.filter((food)=>{
                return food.rating==filterValue
            })
            DisplayFood(data)
        }
     }


     let cartArr=JSON.parse(localStorage.getItem("cart")) || []
     let container=document.getElementById("foodcontainer");
     function DisplayFood(data){
        container.innerHTML=null;
        data.forEach((food)=>{
            let card=document.createElement("div")
            let imgdiv=document.createElement("div")
            let img=document.createElement("img")
            img.src=food.img;

            let name=document.createElement("h2")
            name.textContent=food.name;

            let price=document.createElement("h4")
            price.textContent=`â‚¹${food.price}`;

            let rating=document.createElement("h4")
            rating.textContent=`Rating:-${food.rating}/5`;

            let desc=document.createElement("p")
            desc.textContent=food.desc;
             
            let addToCart=document.createElement("button")
            addToCart.textContent="Add to Cart"

            addToCart.addEventListener("click",()=>{
                if(checkDuplicate(food)){
                    alert("Product Already in Cart")
                }else{
                    cartArr.push({...food,quantity:1})
                localStorage.setItem("cart",JSON.stringify(cartArr))
                alert("Product Added in Cart")
                }
            })
            imgdiv.append(img)
            card.append(imgdiv,name,price,rating,desc,addToCart)
            container.append(card)

        })
     }

     function checkDuplicate(food){
        for(let i=0;i<cartArr.length;i++){
            if(cartArr[i].id===food.id){
                return true
            }
        }
        return false
     }
</script>